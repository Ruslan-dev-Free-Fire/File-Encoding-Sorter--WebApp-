<!DOCTYPE html>
<html>
<head>
<title>File Encoding Sorter</title>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="{{ url_for('static', filename='favicon.ico') }}" rel="icon" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='FileEncodingSorter/style.css') }}">
    <script type="text/javascript" src="{{ url_for('static', filename='FileEncodingSorter/script.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.2/sockjs.min.js"></script>

</head>
<body>
    <header class="rh8nkv-0 hoywjo">
<div class="rh8nkv-1 llspIR">
            <h1 class="rh8nkv-2 fHlUjz">File Encoding Sorter</h1>
            <h2 class="rh8nkv-6 fvIoRp">ワンクリックでドキュメントをコーディング別に整理！</h2>
        </div>
        <div class="rh8nkv-3 gcKsMX" id="file-drop-area">
            <div class="fp19qh-0 cjZeTl">
                <div class="tbjvbz-0 kYTCXp">
                    <div class="tbjvbz-1 dVwpTd">
                        <div class="flex-container sc-10126gd-0 dHiqbD" id="__cond-705618">
                            <label class="sc-8s01yt-0 deyfvp">
                                <div data-test-id="intro-tool-droparea" class="sc-7sg2r-0 QrMRD">
                                    <div class="sc-7sg2r-1 bFabPl"></div>
                                    <div class="sc-8s01yt-1 vma-Dc">
                                        <form class="sc-16z3mvs-1 GbsEV" method="post" enctype="multipart/form-data" action="{{ url_for('file_encoding_sorter') }}">
    <label class="sc-16z3mvs-2 dAA-dEm">
        <input type="file" name="file" accept=".txt" class="hidden-input sc-16z3mvs-0 kbLfHX">
        <div class="sc-8s01yt-2 fLFedC">
            <div class="sc-8s01yt-4 GrhAj">
                <div class="sc-2xfn8l-0 bWaBkl sc-1ohxvl7-0 kvbqhA">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 60">
                        <!-- Здесь должен быть ваш код SVG-иконки -->
                    </svg>
                </div>
            </div>
            <div class="l3tlg0-6 kkceuK">
                <button type="button" class="l3tlg0-0 ggoliT" onclick="document.querySelector('.sc-16z3mvs-0.kbLfHX').click();">
    <div class="sc-2xfn8l-0 bWaBkl sc-2wite4-0 itDlvX">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <!-- Ваш код SVG-иконки -->
        </svg>
    </div>
    <span class="sc-8s01yt-5 gGeCVP">ファイルの選択</span>
</button>
            </div>
            <div class="sc-8s01yt-3 eJIBCe">またはここにファイルをドラッグします</div>
        </div>
    </label>
</form>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <div class="flash-messages">
        <!-- Здесь выведем flash-сообщения -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul class="flash-messages-list">
                    {% for category, message in messages %}
                        <li class="flash-message {{ category }}">{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
    </div>
    <div class="hidden-input sc-16z3mvs-0 kbLfHX"></div>

    <div class="mytextlogfile" id="log">
    {% for message in messages %}
        <div class="log-entry">{{ message }}</div>
    {% endfor %}
</div>


<!-- Ваш код для кнопки "Start sorting" -->
<a class="iksweb" href="#" title="Start sorting" id="start-sorting">Start sorting</a>


<script>
// Только лог
// Функция для загрузки лога сообщений при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    // Получаем сохраненный лог из localStorage
    const log = localStorage.getItem('log');

    // Проверяем, есть ли сохраненный лог
    if (log) {
        // Найдем элемент с классом "mytextlogfile"
        const logContainer = document.querySelector('.mytextlogfile');

        // Устанавливаем содержимое элемента равным сохраненному логу
        logContainer.innerHTML = log;
    }
});

// Функция для очистки лога при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    // Удаляем сохраненный лог из localStorage
    localStorage.removeItem('log');

    // Найдем элемент с классом "mytextlogfile"
    const logContainer = document.querySelector('.mytextlogfile');

    // Очищаем отображаемый лог сообщений на странице
    logContainer.innerHTML = '';
});

// Обработчик изменения файла
document.querySelector('.sc-16z3mvs-0.kbLfHX').addEventListener('change', function() {
    // Получаем текущий элемент ввода файла
    var fileInput = this;

    // Проверяем, что пользователь выбрал файл
    if (fileInput.files.length > 0) {
        // Получаем информацию о выбранном файле
        var file = fileInput.files[0];

        // Разрешенные расширения файлов
        var allowedExtensions = ['txt'];

        // Получаем расширение выбранного файла и приводим его к нижнему регистру
        var fileExtension = file.name.split('.').pop().toLowerCase();

        // Проверяем, соответствует ли расширение разрешенным
        if (allowedExtensions.indexOf(fileExtension) === -1) {
            // Выводим предупреждение, если расширение не разрешено
            alert('Only files with the extension .txt are allowed');

            // Очищаем поле ввода файла, чтобы пользователь мог выбрать другой файл
            fileInput.value = '';
        } else {
            // Автоматически отправляем форму, к которой принадлежит файловый ввод
            fileInput.form.submit();
        }
    }
});
// Только лог end
</script>


</body>
</html>
